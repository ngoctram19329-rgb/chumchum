<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin - LocketGold Chum</title>

<style>
body{
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg,#fff0f6,#ffffff);
  margin:0;
  padding:20px;
}

.header{
  background: linear-gradient(90deg,#ff66a3,#ffb84d);
  color:white;
  padding:18px;
  border-radius:16px;
  margin-bottom:25px;
  text-align:center;
  box-shadow:0 6px 20px rgba(255,105,180,0.25);
}

h2{
  margin:0;
  font-weight:600;
}

.card{
  background:white;
  padding:18px;
  margin-bottom:18px;
  border-radius:18px;
  box-shadow:0 8px 25px rgba(0,0,0,0.08);
  border:1px solid #ffe0ec;
}

.card p{
  margin:6px 0;
}

.status{
  font-weight:600;
}

.pending{
  color:#ff66a3;
}

.approved{
  color:#e6a700;
}

button{
  padding:8px 14px;
  border:none;
  border-radius:12px;
  cursor:pointer;
  margin-top:10px;
  margin-right:6px;
  font-weight:600;
}

.btn-approve{
  background: linear-gradient(90deg,#ff66a3,#ffb84d);
  color:white;
}

.btn-delete{
  background:#ffe6f0;
  color:#ff4d88;
}
</style>
</head>

<body>

<div class="header">
  <h2>Quản lý đơn hàng - LocketGold Chum</h2>
</div>

<div id="orders"></div>

<script>
const BACKEND = "https://chumchum-backend-2.onrender.com";

function loadOrders(){
  fetch(BACKEND + "/orders")
  .then(res=>res.json())
  .then(data=>{
    const container = document.getElementById("orders");
    container.innerHTML = "";

    if(data.length === 0){
      container.innerHTML = "<p>Chưa có đơn hàng nào.</p>";
      return;
    }

    data.reverse().forEach(order=>{
      const div = document.createElement("div");
      div.className = "card";

      div.innerHTML = `
        <p><b>Mã đơn:</b> ${order.id}</p>
        <p><b>Tên:</b> ${order.name}</p>
        <p><b>SĐT:</b> ${order.phone}</p>
        <p><b>Sản phẩm:</b> ${order.product}</p>
        <p><b>Số tiền:</b> ${order.price.toLocaleString()}đ</p>
        <p class="status ${order.status}">
          Trạng thái: ${order.status === "approved" ? "Đã duyệt" : "Chờ duyệt"}
        </p>
      `;

      if(order.status !== "approved"){
        const btn = document.createElement("button");
        btn.innerText = "Duyệt đơn";
        btn.className = "btn-approve";
        btn.onclick = ()=> approveOrder(order.id);
        div.appendChild(btn);
      }

      const del = document.createElement("button");
      del.innerText = "Xoá";
      del.className = "btn-delete";
      del.onclick = ()=> deleteOrder(order.id);
      div.appendChild(del);

      container.appendChild(div);
    });
  });
}

function approveOrder(id){
  fetch(BACKEND + "/approve/" + id)
  .then(()=> loadOrders());
}

function deleteOrder(id){
  fetch(BACKEND + "/delete/" + id)
  .then(()=> loadOrders());
}

loadOrders();
setInterval(loadOrders,5000);
</script>

</body>
</html>
